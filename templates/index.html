
{% extends "base.html" %}

{% block content %}
<div class="container-fluid overlflow-y-hidden">
  <div class="row">
    <!-- Sidebar -->
    <div class="sidebar col-md-3 col-lg-3 bg-light p-3 border-end" style="height: 100vh; position:fixed; width: 300px;">
      <h4 class="mb-3">Configurações</h4>
      <form method="POST">
        <div class="mb-3">
          <label for="inicio" class="form-label">Início</label>
          <select name="inicio" id="inicio" class="form-select">
            {% for no in nos %}
              <option value="{{ no }}">{{ no }}</option>
            {% endfor %}
          </select>
        </div>

        <div class="mb-3">
          <label for="fim" class="form-label">Objetivo</label>
          <select name="fim" id="fim" class="form-select">
            {% for no in nos %}
              <option value="{{ no }}">{{ no }}</option>
            {% endfor %}
          </select>
        </div>

        <div class="mb-3">
          <label for="algoritmo" class="form-label">Algoritmo</label>
          <select name="algoritmo" id="algoritmo" class="form-select" onchange="toggleLimit()">
            <option value="amplitude">Amplitude</option>
            <option value="profundidade">Profundidade</option>
            <option value="prof_limitada">Profundidade Limitada</option>
            <option value="aprof_iterativo">Aprofundamento Iterativo</option>
            <option value="bidirecional">Bidirecional</option>
            <option value="custo_uniforme">Custo Uniforme</option>
            <option value="greedy">Greedy</option>
            <option value="a*">A*</option>
            <option value="aia*">AIA*</option>
          </select>
        </div>

        <div class="mb-3" id="limit-input" style="display:none;">
          <label for="lim" class="form-label">Limite (lim / lim_max)</label>
          <input type="number" name="lim" id="lim" class="form-control" min="1" value="2">
        </div>

        <button type="submit" class="btn btn-primary w-100">Encontrar Caminho</button>
      </form>
    </div>

    <!-- Main content -->
    <div class="col-md-9 col-lg-9 p-4 ml-16" style="margin-left: 310px;">
      <h1 class="mb-4">Busca</h1>
      {% if img %}
        <h3>Mapa:</h3>
        <img src="data:image/png;base64,{{ img }}" class="rounded mx-auto d-block img-fluid img-thumbnail" style="width: 550px;"/>
      {% endif %}

      <div class="mt-4"></div>

      {% if result %}
        <div class="alert alert-info">
          <strong>Caminho:</strong> {{ result }}
        </div>
      {% endif %}

      {% if custo %}
        <div class="alert alert-info">
          <strong>Custo:</strong> {{ custo }}
        </div>
      {% endif %}

    </div>
  </div>
</div>

<script>
function toggleLimit() {
  const algoritmo = document.getElementById("algoritmo").value;
  const limitInput = document.getElementById("limit-input");

  if (algoritmo === "prof_limitada" || algoritmo === "aprof_iterativo") {
    limitInput.style.display = "block";
    document.getElementById("lim").value = algoritmo === "aprof_iterativo" ? 4 : 2;
  } else {
    limitInput.style.display = "none";
  }
}

toggleLimit();
</script>
{% endblock %}
